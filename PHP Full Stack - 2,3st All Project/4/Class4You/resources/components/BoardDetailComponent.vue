<template>
    <div class="wrapper">
        <div class="board_detail_wrap">
            <!-- <div class="whr"><span>Í≤åÏãúÌåê</span><span>></span><span>ÏÉÅÏÑ∏ Í≤åÏãúÌåê</span></div> -->
            <div class="whr">
                <router-link to="/board">Í≤åÏãúÌåê</router-link>
                <span>></span>
                <span>ÏÉÅÏÑ∏ Í≤åÏãúÌåê</span>
            </div>
            <div class="main_visual">
                        <div class="main_visual_slider">
                            <div class="main_visual_slider_list">
                                <div class="main_visual_slider_track">
                                    <div class="main_visual_slider_track_slick">
                                        <div class="main_visual_slider_track_slick_item">
                                            <a href="">
                                                <img src="/img/banner/banner5.png">
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div style="margin-bottom: 50px;"></div>
            <section class="mainSectionpost">
                <section class="mainSec row jcB">
                    <div class="postBox">
                        <div class="postInfo row aiC jcB">
                            <div>
                                <p>ÏûëÏÑ±Ïûê : <span>{{ newBoardItem.UserEmail }}</span></p>
                            </div>
                            <div class="row aiC">
                                <p>ÏûëÏÑ±Ïùº<span>{{ newBoardItem.created_at }}</span></p>
                                <p>Ï°∞ÌöåÏàò<span>{{newBoardItem.BoardView}}</span></p>
                                <p>Ï¢ãÏïÑÏöî<span>{{newBoardItem.BoardRecommended}}</span></p>
                            </div>
                        </div>
                        <div class="postTitBox row aiC">
                            <label for="postTit">Ï†úÎ™© : </label>
                            <p type="text" id="postTit">{{ newBoardItem.BoardTitle }}</p>
                        </div>
                        <div class="postContBox row">

                            <label for="postCont">ÎÇ¥Ïö© : </label> 
                            <p class="postCont" style="white-space: pre-line;">{{ newBoardItem.BoardComment }}</p>
                        </div>
                        <div class="laguage">
                            <!-- <ul class="row aiC laguage_gap_10">
                                <li>React</li>
                                <li>JS</li>
                                <li>CSS</li>
                                <li>HTML</li>
                                <li>LARAVEL</li>
                                <li>React</li>
                            </ul> -->
                        </div>
                        <div class="reco row jcC">
                            <!-- <div class="row aiC cibal_class_name_jangnan">
                                <p>{{recommendationCount}}</p>Ï∂îÏ≤ú
                                <button type="button" @click="updateRecommendedBoardData()"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-hand-thumbs-up-fill" viewBox="0 0 16 16"><path d="M6.956 1.745C7.021.81 7.908.087 8.864.325l.261.066c.463.116.874.456 1.012.965.22.816.533 2.511.062 4.51a9.84 9.84 0 0 1 .443-.051c.713-.065 1.669-.072 2.516.21.518.173.994.681 1.2 1.273.184.532.16 1.162-.234 1.733.058.119.103.242.138.363.077.27.113.567.113.856 0 .289-.036.586-.113.856-.039.135-.09.273-.16.404.169.387.107.819-.003 1.148a3.163 3.163 0 0 1-.488.901c.054.152.076.312.076.465 0 .305-.089.625-.253.912C13.1 15.522 12.437 16 11.5 16H8c-.605 0-1.07-.081-1.466-.218a4.82 4.82 0 0 1-.97-.484l-.048-.03c-.504-.307-.999-.609-2.068-.722C2.682 14.464 2 13.846 2 13V9c0-.85.685-1.432 1.357-1.615.849-.232 1.574-.787 2.132-1.41.56-.627.914-1.28 1.039-1.639.199-.575.356-1.539.428-2.59z"/></svg></button>
                            </div> -->

                            <!-- <button @click="updateRecommendedBoardData()" class="high-five like_button_color" :class="{'detali_like_state_on': recommendationState === 'like'}">
                                <span v-if="recommendationState === 'like'">Like!</span>
                                <span v-else>Ï¢ãÏïÑÏöî</span>
                                <div class="hands">
                                    <svg class="left" viewBox="0 0 32 36">
                                    <ellipse cx="14" cy="13" rx="9" ry="11" />
                                    <path
                                        d="M16.0011 5.5C15.5011 3.5 13.5012 4 12.5012 5.5C11.5012 7 9.5 14 9.75 20M16.0011 5.5C14.9998 8 13.9981 12 13.9994 16.5M16.0011 5.5C16.5011 4.5 17.5646 2.5 18.4994 2.5C19.737 2.5 20.7439 3.28645 20.5011 4.5M23.4981 7.5C23.4981 7.5 21.9994 12 21.9994 16M23.4981 7.5C24.9981 5.5 27.0011 7 27.0011 8.5C26.7527 10.9503 25.2188 11.8879 25.4985 25.5C25.6052 30.6943 21.6939 34 16.4985 34C11.5003 34 6.59828 29.4598 6.0011 23.5C5.5001 18.5 6.64678 15.1392 7.50115 14C9.00115 12 9.51575 14.5859 9.50102 16C9.48502 17.5364 9.65 20 9.65 20M23.4981 7.5C24 6 23.5 2.5 20.5011 4.5M20.5011 4.5C19.0011 8 17.9994 11.5 17.9994 16.5"
                                    />
                                    </svg>
                                    <svg class="right" viewBox="0 0 32 36">
                                    <ellipse cx="14" cy="13" rx="9" ry="11" />
                                    <path
                                        d="M16.0011 5.5C15.5011 3.5 13.5012 4 12.5012 5.5C11.5012 7 9.5 14 9.75 20M16.0011 5.5C14.9998 8 13.9981 12 13.9994 16.5M16.0011 5.5C16.5011 4.5 17.5646 2.5 18.4994 2.5C19.737 2.5 20.7439 3.28645 20.5011 4.5M23.4981 7.5C23.4981 7.5 21.9994 12 21.9994 16M23.4981 7.5C24.9981 5.5 27.0011 7 27.0011 8.5C26.7527 10.9503 25.2188 11.8879 25.4985 25.5C25.6052 30.6943 21.6939 34 16.4985 34C11.5003 34 6.59828 29.4598 6.0011 23.5C5.5001 18.5 6.64678 15.1392 7.50115 14C9.00115 12 9.51575 14.5859 9.50102 16C9.48502 17.5364 9.65 20 9.65 20M23.4981 7.5C24 6 23.5 2.5 20.5011 4.5M20.5011 4.5C19.0011 8 17.9994 11.5 17.9994 16.5"
                                    />
                                    </svg>
                                </div>
                                <div class="success like_button_bg_color"><span style="line-height: 38px;">Like!</span></div>
                            </button> -->
                            <div style="display: flex; padding: 15px 30px; gap: 20px; border: 1px solid #c6c6c61f; box-shadow: 0px 5px 10px 1px #ebebeb; border-radius: 20px;">
                                <svg style="position: relative; top: -6px" class="board_detail_like" :class="{ 'click': likeisClicked }" @click="updateRecommendedBoardData()" xmlns="http://www.w3.org/2000/svg" version="1.0" width="300.000000pt" height="300.000000pt" viewBox="0 0 300.000000 300.000000" preserveAspectRatio="xMidYMid meet">
                                    <g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)" stroke="none">
                                    <path d="M963 2645 c-37 -19 -60 -40 -82 -73 -56 -88 -64 -137 -70 -462 l-6 -295 -225 -5 c-211 -5 -228 -7 -273 -29 -84 -41 -130 -124 -130 -236 0 -57 21 -152 118 -525 64 -250 128 -475 140 -500 27 -52 68 -94 108 -109 38 -15 945 -15 983 -1 32 13 243 161 296 208 57 51 60 81 56 517 -3 348 -5 383 -22 415 -10 19 -143 159 -296 310 -251 249 -281 282 -313 347 -35 71 -64 180 -87 320 -7 41 -21 87 -34 105 -30 45 -89 50 -163 13z"/>
                                    <path d="M2134 1666 c-67 -29 -64 -1 -64 -623 0 -414 3 -569 12 -588 24 -52 41 -55 373 -55 l307 0 29 29 29 29 0 574 c0 636 3 605 -66 634 -47 20 -574 20 -620 0z"/>
                                    </g>
                                </svg>

                                <div class="board_detail_like_num">{{ likeCount }}</div>

                                <svg style="position: relative; top: 6px" class="board_detail_like" :class="{ 'click': hateisClicked }"  @click="updateNotRecommendedBoardData()" xmlns="http://www.w3.org/2000/svg" version="1.0" width="300.000000pt" height="300.000000pt" viewBox="0 0 300.000000 300.000000" preserveAspectRatio="xMidYMid meet">
                                    <g transform="translate(0.000000,300.000000) scale(0.100000,-0.100000)" stroke="none">
                                    <path d="M209 2571 l-29 -29 0 -574 c0 -636 -3 -605 66 -634 48 -20 570 -20 618 0 69 29 66 -1 66 623 0 414 -3 569 -12 588 -24 52 -41 55 -373 55 l-307 0 -29 -29z"/>
                                    <path d="M1471 2589 c-30 -12 -244 -163 -293 -207 -57 -51 -60 -81 -56 -517 3 -348 5 -383 22 -415 10 -19 143 -159 296 -310 251 -249 281 -282 313 -347 35 -71 64 -180 87 -320 16 -100 42 -137 99 -141 65 -5 141 36 180 96 56 88 64 137 70 462 l6 295 225 5 c211 5 228 7 273 29 84 41 130 124 130 236 0 57 -21 152 -118 525 -64 250 -128 475 -140 500 -27 52 -68 94 -108 109 -36 14 -952 14 -986 0z"/>
                                    </g>
                                </svg>
                            </div>
                            <!-- <button @click="updateNotRecommendedBoardData()" class="high-five" :class="{'detali_hate_state_on': recommendationState === 'hate'}">
                                <span v-if="recommendationState === 'hate'">Hate!</span>
                                <span v-else>Ïã´Ïñ¥Ïöî</span>
                                <div class="hands">
                                    <svg class="left" viewBox="0 0 32 36">
                                    <ellipse cx="14" cy="13" rx="9" ry="11" />
                                    <path
                                        d="M16.0011 5.5C15.5011 3.5 13.5012 4 12.5012 5.5C11.5012 7 9.5 14 9.75 20M16.0011 5.5C14.9998 8 13.9981 12 13.9994 16.5M16.0011 5.5C16.5011 4.5 17.5646 2.5 18.4994 2.5C19.737 2.5 20.7439 3.28645 20.5011 4.5M23.4981 7.5C23.4981 7.5 21.9994 12 21.9994 16M23.4981 7.5C24.9981 5.5 27.0011 7 27.0011 8.5C26.7527 10.9503 25.2188 11.8879 25.4985 25.5C25.6052 30.6943 21.6939 34 16.4985 34C11.5003 34 6.59828 29.4598 6.0011 23.5C5.5001 18.5 6.64678 15.1392 7.50115 14C9.00115 12 9.51575 14.5859 9.50102 16C9.48502 17.5364 9.65 20 9.65 20M23.4981 7.5C24 6 23.5 2.5 20.5011 4.5M20.5011 4.5C19.0011 8 17.9994 11.5 17.9994 16.5"
                                    />
                                    </svg>
                                    <svg class="right" viewBox="0 0 32 36">
                                    <ellipse cx="14" cy="13" rx="9" ry="11" />
                                    <path
                                        d="M16.0011 5.5C15.5011 3.5 13.5012 4 12.5012 5.5C11.5012 7 9.5 14 9.75 20M16.0011 5.5C14.9998 8 13.9981 12 13.9994 16.5M16.0011 5.5C16.5011 4.5 17.5646 2.5 18.4994 2.5C19.737 2.5 20.7439 3.28645 20.5011 4.5M23.4981 7.5C23.4981 7.5 21.9994 12 21.9994 16M23.4981 7.5C24.9981 5.5 27.0011 7 27.0011 8.5C26.7527 10.9503 25.2188 11.8879 25.4985 25.5C25.6052 30.6943 21.6939 34 16.4985 34C11.5003 34 6.59828 29.4598 6.0011 23.5C5.5001 18.5 6.64678 15.1392 7.50115 14C9.00115 12 9.51575 14.5859 9.50102 16C9.48502 17.5364 9.65 20 9.65 20M23.4981 7.5C24 6 23.5 2.5 20.5011 4.5M20.5011 4.5C19.0011 8 17.9994 11.5 17.9994 16.5"
                                    />
                                    </svg>
                                </div>
                                <div class="success"><span style="line-height: 38px;">Hate!</span></div>
                            </button> -->
                            
                            <!-- <div>
                                <button @click="updateNotRecommendedBoardData()" class="button-star">
                                    <canvas></canvas>
                                    <div class="label">
                                        <span class="default">ÎπÑÏ∂î<span class="success"> ÏôÑÎ£å</span></span>
                                    </div>
                                    <div class="number">
                                        <span class="current">{{disapprovalCount}}</span>
                                        <span class="new">{{disapprovalCount + 1}}</span>
                                        <div class="add">+1</div>
                                    </div>
                                </button>
                            </div> -->
                            <!-- <div class="row aiC cibal_class_name_jangnan">
                                <button type="button" @click="updateNotRecommendedBoardData()"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-hand-thumbs-down-fill" viewBox="0 0 16 16"><path d="M6.956 14.534c.065.936.952 1.659 1.908 1.42l.261-.065a1.378 1.378 0 0 0 1.012-.965c.22-.816.533-2.512.062-4.51.136.02.285.037.443.051.713.065 1.669.071 2.516-.211.518-.173.994-.68 1.2-1.272a1.896 1.896 0 0 0-.234-1.734c.058-.118.103-.242.138-.362.077-.27.113-.568.113-.856 0-.29-.036-.586-.113-.857a2.094 2.094 0 0 0-.16-.403c.169-.387.107-.82-.003-1.149a3.162 3.162 0 0 0-.488-.9c.054-.153.076-.313.076-.465a1.86 1.86 0 0 0-.253-.912C13.1.757 12.437.28 11.5.28H8c-.605 0-1.07.08-1.466.217a4.823 4.823 0 0 0-.97.485l-.048.029c-.504.308-.999.61-2.068.723C2.682 1.815 2 2.434 2 3.279v4c0 .851.685 1.433 1.357 1.616.849.232 1.574.787 2.132 1.41.56.626.914 1.28 1.039 1.638.199.575.356 1.54.428 2.591z"/></svg></button>
                                ÎπÑÏ∂îÏ≤ú<p>{{disapprovalCount}}</p>
                            </div> -->
                        </div>
                        
                        <div class="board_button">
                            <div class="board_detail_report_div">
                                <div class="board_detail_report_btn">
                                    <button v-if="$store.state.userLoginChk" type="button" @click="boardReport()">üö® Í≤åÏãúÍ∏Ä Ïã†Í≥†</button>
                                </div>
                            </div>

                            <div v-if="newBoardItem.UserID == $store.state.UserID"  class="row aiC">
                                <a v-if="newBoardItem.BoardFlg == '0'" @click="updatecompleteBoardData()" class="board_complete">Ìï¥Í≤∞</a>
                                <a :href="'/boardupdate/' + newBoardItem.BoardID" v-if="$store.state.UserID" class="board_rewrite">ÏàòÏ†ï</a>
                                <!-- <a @click="deleteBoardData(newBoardItem.BoardID)" class="board_delete">ÏÇ≠Ï†ú</a> -->
                                <!-- <button @click="deleteBoardData(newBoardItem.BoardID)" class="board_delete">ÏÇ≠Ï†ú</button> -->
                                <!-- <a @click="deleteBoardData(newBoardItem.BoardID)" class="board_delete">ÏÇ≠Ï†ú</a> -->
                                <button @click="deleteBoardData(newBoardItem.BoardID)" :class="{ 'class_detail_rating_user_delete_button': true, ['boardID' + newBoardItem.BoardID]: true }" >
									<div class="class_detail_rating_user_delete_trash">
										<div class="class_detail_rating_user_delete_top">
											<div class="class_detail_rating_user_delete_paper"></div>
										</div>
										<div class="class_detail_rating_user_delete_box"></div>
										<div class="class_detail_rating_user_delete_check">
											<svg viewBox="0 0 8 6">
												<polyline points="1 3.4 2.71428571 5 7 1"></polyline>
											</svg>
										</div>
									</div>
									<span>ÏÇ≠Ï†ú</span>
								</button>
                            </div>
                        </div>

                        
                    </div>
            
                    <div class="reviewBox border-t-none">
                        <!-- <div class="number">
                            <p>ÎãµÎ≥Ä<span>0</span></p>
                        </div> -->
                            <div class="Commentnumber">
                                <p>ÎãµÎ≥Ä <span>{{ newCommentItem.length }}</span></p>
                            </div>
                        <div class="reviewList">
                            <p class="board_detail_user_id">{{nowUserID.UserEmail}}</p>
                        </div>
                        <div class="reviewPost row jcB">
                            <!-- <textarea placeholder="ÎåìÍ∏ÄÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî." v-model="frmCommentData.CommentContent"></textarea> -->
                            <textarea placeholder="ÎåìÍ∏ÄÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî." v-model="commentData.CommentContent"></textarea>
                            <!-- <textarea placeholder="ÎåìÍ∏ÄÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî." v-model="newCommentItem.CommentContent"></textarea> -->
                            <!-- <button type="button" @click="submitCommentData()">Ï†ÄÏû•</button> -->
                            <button @click="addBoardComment()">Ï†ÄÏû•</button>
                        </div>
                    </div>
                    <div class="reviewBox border-t-none" style="padding: 10px 0px;">
                        <div v-for="item in newCommentItem" :key="item.CommentID" class="reviewList">
                            <div class="item">
                                <div class="commentInfo row aiC jcB">
                                    <p class="comment_writer">ÏûëÏÑ±Ïûê<span>{{ hideEmail(item.UserEmail) }}</span></p>
                                    <div class="comment_created_report_div">
                                        <p>ÏûëÏÑ±Ïùº<span>{{ item.created_at }}</span></p>
                                        
                                    </div>
                                </div>
                                <div class="commentText">
                                    <textarea v-if="item.CommentID == updateCommentID" v-model="item.CommentContent" class="board_comment_update_textarea"></textarea>
                                    <span v-else>{{ item.CommentContent }}</span>   
                                </div>
                                
                                <div class="commentActions row aiC">
                                    <button v-if="$store.state.userLoginChk" class="comment_report_btn" type="button" @click="commentReport(item.CommentID)">üö® ÎåìÍ∏ÄÏã†Í≥†</button>
                                    <div v-if="item.UserID == $store.state.UserID" style="margin-left: auto;">
                                        <div v-if="item.CommentID == updateCommentID" >
                                            <button @click="addUpdateComment(item)" class="commentActions_updateBtn">ÏàòÏ†ï</button>
                                            <button @click="updateCommentID = false" class="commentActions_deleteBtn">Ï∑®ÏÜå</button>
                                        </div>    
                                            <!-- <button class="comment_editBtn">ÏàòÏ†ï</button> -->
                                        <div style="display: flex;" v-else>
                                            <button @click="updateCommentID = item.CommentID" class="commentActions_updateBtn">ÏàòÏ†ï</button>
                                            <button @click="deleteCommentData(item.CommentID)" :class="{ 'class_detail_rating_user_delete_button': true, ['commentID' + item.CommentID]: true }" style="padding: 5px 20px">
                                                <div class="class_detail_rating_user_delete_trash">
                                                    <div class="class_detail_rating_user_delete_top">
                                                        <div class="class_detail_rating_user_delete_paper"></div>
                                                    </div>
                                                    <div class="class_detail_rating_user_delete_box"></div>
                                                    <div class="class_detail_rating_user_delete_check">
                                                        <svg viewBox="0 0 8 6">
                                                            <polyline points="1 3.4 2.71428571 5 7 1"></polyline>
                                                        </svg>
                                                    </div>
                                                </div>
                                                <span>ÏÇ≠Ï†ú</span>
                                            </button>
                                            <!-- <button @click="deleteCommentData(item.CommentID)" class="commentActions_deleteBtn">ÏÇ≠Ï†ú</button> -->
                                            <!-- <button class="commentActions_reportBtn">Ïã†Í≥†</button> -->
                                        </div>
                                    </div>
                                </div>
                                <hr style="margin-top: 20px;">
                            </div>       
                        </div>
                    </div>
                </section> 
            </section>
        </div>
    </div>
    <!-- <div v-if="showEditModalFlag" class="modal">
        <div class="modal-content">
            <span class="close" @click="closeEditModal">&times;</span>
            <textarea v-model="editCommentContent"></textarea>
            <button @click="updateCommentData(editingCommentId)">Ï†ÄÏû•</button>
        </div>
    </div> -->

</template>
<script>
import Swal from 'sweetalert2';
import * as THREE from 'three';
import gsap from 'gsap';
export default {
    name: 'BoardDetailComponent',

    props: ['BoardID'],

    data() {
        return {
            newBoardItem: {
            },
            nowUserID: {},
            // newCommentItem: {
            // },
            newCommentItem: [],
            newComment: '', 

            // frmCommentData: {
            //     UserID: this.$store.state.UserID,
            //     BoardID: this.BoardID,
            //     CommentID: this.CommnetID,
            //     CommentContent: '',
            // },
            commentData: {
                UserID: this.$store.state.UserID,
                UserEmail: this.$store.state.UserEmail,
                BoardID: this.BoardID,
                CommentID: this.CommentID,
                CommentContent: '',
            },
            // commentData: [
            //     {
            //         UserID: this.$store.state.UserID,
            //         UserEmail: this.$store.state.UserEmail,
            //         BoardID: this.BoardID,
            //         CommentID: this.CommentID,
            //         CommentContent: '',
            //     }
            // ],
            commentItems: [],
            newCommentData() {
                return {
                    UserID: this.$store.state.UserID,
                    UserEmail: this.$store.state.UserEmail,
                    BoardID: this.BoardID,
                    CommentID: this.CommentID,
                    CommentContent: '',
                };
            },
            updateCommentData: {},
            updateCommentID: {},
            // recommendationCount: 0,
            // disapprovalCount: 0,

            likeCount: 0,

            // Í≤åÏãúÍ∏Ä Ïã†Í≥†
            boardReportData: {
                UserID: this.$store.state.UserID,
                UserEmail: this.$store.state.UserEmail,
                BoardID: this.BoardID,
                CommentID: this.CommentID,
                ReportContent: this.ReportContent,
            },
            newReportData: {},
            commentReportData: {
                UserID: this.$store.state.UserID,
                CommentID: this.CommentID,
                ReportContent: this.ReportContent,
            },
            reportData: [],

            recommendationState: false,
            
            likeisClicked: false,
            hateisClicked: false,
        };
    },

    mounted() {
        this.fetchData();

        const scene = new THREE.Scene();
        // Ïä§ÌÅ¨Î¶ΩÌä∏Î•º Î°úÎìúÌïòÎäî Ìï®ÏàòÎ•º Ï†ïÏùò
        const loadScript = (src, callback) => {
        const script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = src;
        script.onload = callback;
        document.head.appendChild(script);
        };

        // Î°úÎìúÌï† Ïô∏Î∂Ä Ïä§ÌÅ¨Î¶ΩÌä∏Îì§Ïùò Î∞∞Ïó¥Î°ú Ï†ïÏùò
        const externalScriptsToLoad = [
        'https://assets.codepen.io/16327/MorphSVGPlugin3.min.js',
        'https://unpkg.co/gsap@3/dist/gsap.min.js'
        ];

        // Î°úÎìúÌï† ÎÇ¥Î∂Ä Ïä§ÌÅ¨Î¶ΩÌä∏Ïùò Í≤ΩÎ°úÎ•º Ï†ïÏùò
        const internalScriptToLoad = '/js/LikeButtonScript.js';

        // Ïô∏Î∂Ä Ïä§ÌÅ¨Î¶ΩÌä∏Î•º Î°úÎìúÌïòÎäî Ìï®Ïàò
        const loadExternalScripts = (scripts, callback) => {
        let loadedScripts = 0;
        const loadNextScript = () => {
            if (loadedScripts < scripts.length) {
            loadScript(scripts[loadedScripts], () => {
                loadedScripts++;
                loadNextScript();
            });
            } else {
            callback();
            }
        };

        loadNextScript();
        };

        // ÎÇ¥Î∂Ä Ïä§ÌÅ¨Î¶ΩÌä∏Î•º Î°úÎìúÌïòÎäî Ìï®Ïàò
        const loadInternalScript = (src, callback) => {
            const script = document.createElement('script');
            script.type = 'module';  // Ïó¨Í∏∞Ïóê type="module" Ï∂îÍ∞Ä
            script.src = src;
            script.onload = callback;
            document.head.appendChild(script);
        };

        // Ïô∏Î∂Ä Ïä§ÌÅ¨Î¶ΩÌä∏Îì§ÏùÑ Î°úÎìúÌïú ÌõÑ ÎÇ¥Î∂Ä Ïä§ÌÅ¨Î¶ΩÌä∏Î•º Î°úÎìú
        loadExternalScripts(externalScriptsToLoad, () => {
            loadInternalScript(internalScriptToLoad, () => {
                // Î™®Îì† Ïä§ÌÅ¨Î¶ΩÌä∏Í∞Ä Î°úÎìúÎêú ÌõÑ Ïã§ÌñâÎê† ÏΩîÎìúÎ•º Ïù¥Í≥≥Ïóê Ï∂îÍ∞Ä
                console.log('All scripts loaded!');
            });
        });
    },

    updated() {
        // console.log('Ïª¥Ìè¨ÎÑåÌä∏Í∞Ä ÏóÖÎç∞Ïù¥Ìä∏ÎêòÏóàÏäµÎãàÎã§.', this.commentItems);
    },

    methods: {
        fetchData() {
        axios.get('/boarddetail/' + this.BoardID)
            .then(response => {
            // console.log(response.data);
                this.newBoardItem = response.data.boardData;
                this.nowUserID = response.data.userID;
                this.newCommentItem = response.data.commentData;
                // this.recommendationCount = response.data.recommendationCount;
                // this.disapprovalCount = response.data.disapprovalCount;
                this.likeCount = response.data.likeCount;
                this.recommendationState = response.data.recommendationState;
                this.reportData = response.data.commentReportData;
                // console.log(response.data.commentData);

                if(this.recommendationState === 'like') {
                    this.likeisClicked = true;
                } else if(this.recommendationState === 'hate') {
                    this.hateisClicked = true;
                } else {
                    this.likeisClicked = false;
                    this.hateisClicked = false;
                }
            })
            .catch(error => {
                console.error('Error fetching data:', error);
            });
        },
        // Ïù¥Î©îÏùº Î≥ÄÌôò Ìï®Ïàò
        hideEmail(email) {
			const atIndex = email.indexOf('@');
			const username = email.substring(0, Math.min(4, atIndex));
			const asterisks = '*'.repeat(atIndex - 4);
			return username + asterisks;
		},

        // ÎåìÍ∏Ä ÏûëÏÑ± Î∂àÎü¨Ïò§Í∏∞
        // submitCommentData() {
        //     this.$store.dispatch('submitCommentData', this.frmCommentData);
        //     console.log(this.frmCommentData);
        // },

        // ÎåìÍ∏Ä ÏûëÏÑ± Ìï®Ïàò
        addBoardComment() {
            if (this.$store.state.userLoginChk) {
                const url = '/comments'
                const header = {
                    headers: {
                        "Content-Type": 'multipart/form-data',
                        'X-CSRF-TOKEN': document.head.querySelector('meta[name="csrf-token"]').content,
                    },
                }

                // TODO : data Î∂ÄÎ∂Ñ Ï∞æÏïÑÍ∞ÄÏßÄÍ≥† Î≥ÄÍ≤ΩÌï¥ÏïºÎåê
                // if(!data.UserID) {
                //     Swal.fire({
                //         icon: 'error',
                //         title: 'Î°úÍ∑∏Ïù∏ ÌôïÏù∏',
                //         text: 'Î°úÍ∑∏Ïù∏ ÌõÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî.',
                //         confirmButtonText: 'ÌôïÏù∏'
                //     });
                // } else if(!data.CommentContent) {
                //     Swal.fire({
                //         icon: 'error',
                //         title: 'ÎÇ¥Ïö© ÌôïÏù∏',
                //         text: 'ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.',
                //         confirmButtonText: 'ÌôïÏù∏'
                //     });
                // }
                let frm = new FormData();
                // console.log(data);

                frm.append('BoardID',this.commentData.BoardID);
                frm.append('UserID',this.commentData.UserID);
                frm.append('UserEmail',this.commentData.UserEmail);
                frm.append('CommentContent',this.commentData.CommentContent);

                // console.log(frm);

                axios.post(url, frm, header)
                .then(res => {
                    Swal.fire({
                        icon: 'success',
                        title: 'ÏôÑÎ£å',
                        text: 'ÎåìÍ∏ÄÏù¥ ÏûëÏÑ±ÎêòÏóàÏäµÎãàÎã§.',
                        confirmButtonText: 'ÌôïÏù∏'
                    })
                    //res.dataÍ∞Ä Ïù¥ÏÉÅÌï®. Îã§Ïãú ÌôïÏù∏Ìï¥ÏïºÌï®
                    // console.log(res.data);
                    // Ïù¥Í≤å ÏûëÏÑ±Îêú ÎåìÍ∏ÄÎ¶¨Ïä§Ìä∏Îì§
                    // console.log(this.newCommentItem);
                    // ÏûëÏÑ±Îêú ÎåìÍ∏Ä Îç∞Ïù¥ÌÑ∞
                    // console.log(this.commentData);
                    // console.log(res.data);
                    // window.location.reload();

                    // unshiftÎäî Î∞∞Ïó¥Ïóê ÏÇ¨Ïö©
                    // this.newCommentItem.unshift(this.commentData);
                    this.newCommentItem.unshift(res.data[0]);
                    // pushÎäî Î∞∞Ïó¥Ïóê Í∞ùÏ≤¥ Ï∂îÍ∞ÄÌï† Îïå ÏÇ¨Ïö©
                    // this.newCommentItem.push({...commentData});
                    // console.log(this.commentData);
                    this.commentData = this.newCommentData();

                })
                .catch(err => {
                    // console.log(err.response.data.errors)
                    // context.commit('setRegistrationErrorMessage', err.response.data.errors);
                })
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Ï†ÄÏû• Ïã§Ìå®',
                    text: 'Î°úÍ∑∏Ïù∏ ÌõÑ ÏûëÏÑ±Ìï¥Ï£ºÏÑ∏Ïöî',
                });
            }
            
        },
        

        // ÎåìÍ∏Ä ÏÇ≠Ï†ú Î∂àÎü¨Ïò§Í∏∞
        // sweetalert2ÏùÑ Ïù¥Ïö©Ìïú ÏïåÎü¨Ìä∏ Ï∂úÎ†• Î∞©Î≤ï
        async deleteCommentData(deleteCommentID) {

            const button = document.querySelector('.class_detail_rating_user_delete_button.commentID' + deleteCommentID);

                if (!button.classList.contains('delete')) {
                button.classList.add('delete');
                setTimeout(() => {
                    button.classList.remove('delete');
                    this.handleDeleteConfirmation2(deleteCommentID);
                }, 1000);
            }
        },
        async handleDeleteConfirmation2(deleteCommentID) {
            // console.log(deleteCommentID);
                Swal.fire({
                title: 'Ï†ïÎßêÎ°ú ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?',
                text: "ÏÇ≠Ï†ú ÌõÑÏóêÎäî Î≥µÍµ¨Ìï† Ïàò ÏóÜÏäµÎãàÎã§.",
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'ÏÇ≠Ï†ú',
                cancelButtonText: 'Ï∑®ÏÜå'
            }).then((result) => {
                // ÏïåÎü¨Ìä∏Ïùò ÌôïÏù∏ Î≤ÑÌä∏ÏùÑ ÎàåÎü¨Ïïº ÏïÑÎûò ifÎ¨∏Ïù¥ trueÍ∞ëÏúºÎ°ú Ïã§ÌñâÎêúÎã§
                if (result.isConfirmed) {
                // this.$store.dispatch('deleteCommentData', data);
                
                console.log(deleteCommentID);
                    const url = '/comments/' + deleteCommentID;
                    const header = {
                        headers: {
                            "Content-Type": 'multipart/form-data',
                            'X-CSRF-TOKEN': document.head.querySelector('meta[name="csrf-token"]').content,
                        },
                    };
                    // const requestData = {
                    //     CommentID: data.CommentID,
                    // };

                // console.log(data);
                // console.log(requestData);

                // axios.delete(url, requestData, header)
                axios.delete(url, header)
                .then(res => { 
                    Swal.fire({
                        icon: 'success',
                        title: 'ÏôÑÎ£å',
                        text: 'ÎåìÍ∏ÄÏù¥ ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.',
                        confirmButtonText: 'ÌôïÏù∏'
            	    })
                    // console.log(this.commentItems);
                    // console.log(res.data);
                    // console.log('response before');
                    // console.log(res.data ? 'true' : 'false');
                    // console.log(this.commentData);
                    // console.log(this.commentItems);
                    // this.newCommentItem = [this.newCommentItem];
                    // console.log(this.newCommentData);
                    // console.log(this.newCommentItem);
                    // Ìï¥Îãπ Ï≤òÎ¶¨Í∞Ä ÎÅùÎÇòÎ©¥ Î¶¨Î°úÎìúÌï®
                    // window.location.reload();
                    // this.newCommentItem = this.newComment.filter((item) => item.CommentID !== requestData.CommentID);
                    // this.newCommentItem = this.commentItems.filter((item) => item.CommentID !== data.CommentID);
                    // this.newCommentItem = this.newCommentData;
                    
                    // this.commentItems = this.commentItems.filter((comment) => comment.CommentID !== data.CommentID);
                    this.newCommentItem = this.newCommentItem.filter((item) => item.CommentID !== deleteCommentID);
                    // console.log('response after');
                    // console.log(this.newCommentItem);
                    
                })
                .catch(err => {
                    // console.log(err.response.data.errors)
                    console.error(err);
						Swal.fire({
							icon: 'error',
							title: 'ÏÇ≠Ï†ú Ïã§Ìå®',
							text: 'ÏÇ≠Ï†ú Ï§ëÏóê Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.',
						});
                    });

                }
            });

        },

        // ÎåìÍ∏Ä ÏàòÏ†ï
        addUpdateComment(data) {
			// console.log(data);
			this.updateCommentData = data;
			// console.log(this.updataReviewData);
			// console.log(data);
			
			axios.put( '/comments', {
                BoardID: this.BoardID,
				UserID: this.updateCommentData.UserID,
				CommentID: this.updateCommentData.CommentID,
				CommentContent: this.updateCommentData.CommentContent,
			})
			.then(response => {
				// console.log(response);
				// ÏÑúÎ≤Ñ ÏùëÎãµÏóê ÎåÄÌïú Î°úÏßÅ ÏàòÌñâ
				// this.$router.push('/board');
				// this.reviewClassItems.unshift(res.data[0]);
				Swal.fire({
                icon: 'success',
                title: 'ÏàòÏ†ï',
                text: 'ÎåìÍ∏ÄÏù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§.',
                confirmButtonText: 'ÌôïÏù∏'
				}).then((result) => {
					this.updateCommentID = false;
				})
			})
			.catch(error => {
				// ÏóêÎü¨ Ï≤òÎ¶¨
				console.error(error);
			});
		
		},

        // Í≤åÏãúÌåê ÏÇ≠Ï†ú Î∂àÎü¨Ïò§Í∏∞
        async deleteBoardData(data) {
			const button = document.querySelector('.class_detail_rating_user_delete_button.boardID' + data);
                if (!button.classList.contains('delete')) {
                button.classList.add('delete');
                setTimeout(() => {
                    button.classList.remove('delete');
                    this.handleDeleteConfirmation(data);
                }, 1000);
            }
        },
        async handleDeleteConfirmation(data) {
            Swal.fire({
                title: 'Ï†ïÎßêÎ°ú ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?',
                text: "ÏÇ≠Ï†ú ÌõÑÏóêÎäî Î≥µÍµ¨Ìï† Ïàò ÏóÜÏäµÎãàÎã§.",
                icon: 'question',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'ÏÇ≠Ï†ú',
                cancelButtonText: 'Ï∑®ÏÜå'
            }).then((result) => {
                if (result.isConfirmed) {
                    // const url = '/boarddetail/' + data
                    const url = '/boarddetail/' + data
                    const header = {
                        headers: {
                            "Content-Type": 'multipart/form-data',
                            'X-CSRF-TOKEN': document.head.querySelector('meta[name="csrf-token"]').content,
                        },
                    // this.$store.dispatch('delBoardData', data);
                    };
                
            axios
                .delete(url, header)
                .then((res) => {

                    // console.log(this.newBoardItem);
                    // this.newBoardItem = this.delBoard();
                    // router.push('/board');
                    this.$router.push('/board');
                })
                .catch((err) => {

                    console.error(err);
                    Swal.fire({
							icon: 'error',
							title: 'ÏÇ≠Ï†ú Ïã§Ìå®',
							text: 'ÏÇ≠Ï†ú Ï§ëÏóê Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.',
						});
                        console.log(err.response);
                    });
                }
            });    

        },

        // Í≤åÏãúÌåê ÏàòÏ†ï Í≤åÏãúÌåê ÌéòÏù¥ÏßÄ
        updateBoardData(data) {
            this.$store.dispatch('updateBoardData', data);
        },
        updatecompleteBoardData() {
            axios.put('/boardCompleteUpdate', {
                BoardID : this.newBoardItem.BoardID,
                UserID: this.newBoardItem.UserID,
                BoardFlg: 1,
            })
            .then(response => {
                // console.log(response.data);
                // ÏÑúÎ≤Ñ ÏùëÎãµÏóê ÎåÄÌïú Î°úÏßÅ ÏàòÌñâ
                this.$router.push('/boarddetail/:BoardID');
                // location.reload();
            })
            .catch(error => {
                // ÏóêÎü¨ Ï≤òÎ¶¨
                console.error(error);
            });
        },
        updateRecommendedBoardData() {
            axios.put('/boardRecommendedUpdate', {
                BoardID : this.newBoardItem.BoardID,
                UserID: this.$store.state.UserID,
            })
            .then(response => {
                // console.log(response.data);
                this.recommendationState = response.data.recommendationState;
                this.likeCount = response.data.likeCount;

                if(this.recommendationState === 'like') {
                    this.likeisClicked = true;
                    this.hateisClicked = false;
                } else if(this.recommendationState === 'hate') {
                    this.likeisClicked = false;
                    this.hateisClicked = true;
                } else {
                    this.likeisClicked = false;
                    this.hateisClicked = false;
                }
                // console.log(this.newBoardItem);
                // ÏÑúÎ≤Ñ ÏùëÎãµÏóê ÎåÄÌïú Î°úÏßÅ ÏàòÌñâ
                // this.$router.push('/board');
                // location.reload();
            })
            .catch(error => {
                // ÏóêÎü¨ Ï≤òÎ¶¨
                console.error(error);
            });
        },
        updateNotRecommendedBoardData() {
            axios.put('/boardNotRecommendedUpdate', {
                BoardID : this.newBoardItem.BoardID,
                UserID: this.$store.state.UserID,
            })
            .then(response => {
                // console.log(response.data);
                this.recommendationState = response.data.recommendationState;
                this.likeCount = response.data.likeCount;

                if(this.recommendationState === 'like') {
                    this.likeisClicked = true;
                    this.hateisClicked = false;
                } else if(this.recommendationState === 'hate') {
                    this.likeisClicked = false;
                    this.hateisClicked = true;
                } else {
                    this.likeisClicked = false;
                    this.hateisClicked = false;
                }
                // ÏÑúÎ≤Ñ ÏùëÎãµÏóê ÎåÄÌïú Î°úÏßÅ ÏàòÌñâ
                // this.$router.push('/board');
                // location.reload();
            })
            .catch(error => {
                // ÏóêÎü¨ Ï≤òÎ¶¨
                console.error(error);
            });
        },

        // Í≤åÏãúÍ∏Ä Ïã†Í≥†
        boardReport() {
            Swal.fire({
                icon: 'info', // Ï∂îÍ∞Ä: ÏïÑÏù¥ÏΩò ÏÑ§Ï†ï
                title: 'Í≤åÏãúÍ∏Ä Ïã†Í≥† ÏÇ¨Ïú†',
                input: 'textarea',
                inputLabel: '-',
                inputPlaceholder: 'Í≤åÏãúÍ∏Ä Ïã†Í≥†ÏÇ¨Ïú†Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî',
                showCancelButton: true,
                cancelButtonText: 'Ï∑®ÏÜå',
                confirmButtonText: 'Ïã†Í≥†ÌïòÍ∏∞',
                showLoaderOnConfirm: true,
                preConfirm: (ReportContent) => {
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            resolve(ReportContent);
                        }, 3000);

                        const url = '/reportSubmit';
                        const header = {
                            headers: {
                            'Content-Type': 'multipart/form-data',
                            }
                        };
                        const formData = new FormData();
                            formData.append('ReportContent', ReportContent);
                            formData.append('BoardID', this.boardReportData.BoardID);
                            
                        axios.post(url, formData, header)
                        .then(res => {
                            // console.log(res.data);
                            
                        })
                        .catch(err => {

                        })
                    });
                }
            }).then((result) => {
                if(result.isConfirmed) {
                    Swal.fire({
                        icon: 'success', // Ï∂îÍ∞Ä: ÏïÑÏù¥ÏΩò ÏÑ§Ï†ï
                        title: 'Ïã†Í≥† ÏôÑÎ£å',
                        text: 'Í≤åÏãúÍ∏ÄÏù¥ Ïã†Í≥†ÎêòÏóàÏäµÎãàÎã§.',
                        confirmButtonText: 'ÌôïÏù∏'
                    })
                } else if(result.isDismissed) {

                };
            })
        },
        commentReport(data) {
            console.log(data);
            const CommentID = data;
            Swal.fire({
                icon: 'info', // Ï∂îÍ∞Ä: ÏïÑÏù¥ÏΩò ÏÑ§Ï†ï
                title: 'ÎåìÍ∏Ä Ïã†Í≥† ÏÇ¨Ïú†',
                input: 'textarea',
                inputLabel: '-',
                inputPlaceholder: 'ÎåìÍ∏Ä Ïã†Í≥†ÏÇ¨Ïú†Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî',
                showCancelButton: true,
                cancelButtonText: 'Ï∑®ÏÜå',
                confirmButtonText: 'Ïã†Í≥†ÌïòÍ∏∞',
                showLoaderOnConfirm: true,
                
                preConfirm: (ReportContent) => {
                    return new Promise((resolve) => {
                        setTimeout(() => {
                            resolve(ReportContent);
                        }, 3000);

                        // const url = '/reportCommentSubmit';
                        const url = '/reportSubmit';
                        const formData = new FormData();
                            formData.append('ReportContent', ReportContent);
                            formData.append('CommentID', CommentID);
                            // formData.append('BoardID', this.commentReportData.BoardID);

                            // console.log(formData);

                        axios.post(url, formData)
                        .then(res => {
                            // console.log(res.data);
                        })
                        .catch(err => {

                        })
                    });
                }
            }).then((result) => {
                if(result.isConfirmed) {
                    Swal.fire({
                        icon: 'success', // Ï∂îÍ∞Ä: ÏïÑÏù¥ÏΩò ÏÑ§Ï†ï
                        title: 'Ïã†Í≥† ÏôÑÎ£å',
                        text: 'ÎåìÍ∏ÄÏù¥ Ïã†Í≥†ÎêòÏóàÏäµÎãàÎã§.',
                        confirmButtonText: 'ÌôïÏù∏'
                    })
                } else if(result.isDismissed) {

                };
            })
        },
        liketoggleClick() {
            this.likeisClicked = !this.likeisClicked;
        },
        hatetoggleClick() {
            this.hateisClicked = !this.hateisClicked;
        },
    }
};
</script>
<style scoped>

.whr a {
    width: 100%;
    margin: 20px auto 10px auto;
    font-size: 14px;
    color: #999;
}
.whr a:hover {
    color: rgb(59, 59, 252);
}
</style>